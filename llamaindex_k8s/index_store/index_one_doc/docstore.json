{"docstore/metadata": {"31b065d7-a16d-41f4-addb-ad12a18e24b6": {"doc_hash": "1ae8b495a1173548bc3adcfa4e17b6b0d706e46a12425d4b18f8fbd40b207c49"}, "cc341eac-530c-4c83-b038-17491c852738": {"doc_hash": "661b42a80b09171fca8795eba3777bf28b45f95d3d2ae13e221c390d77343580", "ref_doc_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6"}, "45a46f47-c07f-46c1-b687-ec087ff708f2": {"doc_hash": "300a6eaf16f32a29cbb24bb112f74d9e12cbc3d0c23d18708ad35b2aa1108129", "ref_doc_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6"}, "31abd24a-7855-423d-a0ef-e79a1b5541dc": {"doc_hash": "df77b484d5982ccdd5072e8506bea4670670b4b94425551ed7a6be007136984d", "ref_doc_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6"}, "90cd4050-91e5-424a-891f-c11d650bf62b": {"doc_hash": "91cf75a91f7aad4a73676b7638ec2a3b338579e9e7d3cf01e8cd1c50e954c1b9", "ref_doc_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6"}, "2e1b1e33-46a3-4d0a-b96d-6dec6943ecba": {"doc_hash": "f5ce879517190665285d5eeb1d11a6897cc56385af1f91d4188538c59dd7b6bf", "ref_doc_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6"}, "5b9ddfb1-90ba-4c58-83b4-3916d8be1b26": {"doc_hash": "93abfcffd3c8571178571a8ff3dd0c7e72406396f04bb374545d6fd525a2cb03", "ref_doc_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6"}, "54a04ff9-769e-4344-9e60-684dfa709b51": {"doc_hash": "2368eebc620a6b4886ad1cd794753b7222e61b56e539b0fb387e629c07a1533e", "ref_doc_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6"}, "7cda0fe3-358e-4272-9dd3-5f14ec4b126e": {"doc_hash": "9420d0bd1609b916c1aa3af911c3905f413761792d9fbbe09dbf65931dcbe9c0", "ref_doc_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6"}, "6a20212d-6f0c-449a-af0f-fdeab3790e28": {"doc_hash": "99102840ac855a10477473d447a9d613da580316f3a0c7a9957cf2cb6ba7ffd1", "ref_doc_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6"}, "b19a3b2a-3330-4e92-a517-dd7288520dba": {"doc_hash": "ecfea34124be01ddf47e2ccd60163cb7547e0bf35b2d36865f30657fc5ae493f", "ref_doc_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6"}}, "docstore/data": {"cc341eac-530c-4c83-b038-17491c852738": {"__data__": {"id_": "cc341eac-530c-4c83-b038-17491c852738", "embedding": null, "metadata": {}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6", "node_type": null, "metadata": {}, "hash": "1ae8b495a1173548bc3adcfa4e17b6b0d706e46a12425d4b18f8fbd40b207c49"}, "3": {"node_id": "45a46f47-c07f-46c1-b687-ec087ff708f2", "node_type": null, "metadata": {}, "hash": "300a6eaf16f32a29cbb24bb112f74d9e12cbc3d0c23d18708ad35b2aa1108129"}}, "hash": "661b42a80b09171fca8795eba3777bf28b45f95d3d2ae13e221c390d77343580", "text": "title: Kubernetes 1.27\uff1a\u66f4\u591a\u7cbe\u7ec6\u7c92\u5ea6\u7684 Pod \u62d3\u6251\u5206\u5e03\u7b56\u7565\u8fdb\u9636\u81f3 Beta\n\nKEP-3022\uff1aPod \u62d3\u6251\u5206\u5e03\u4e2d\u7684\u6700\u5c0f\u57df\u6570\n\nPod \u62d3\u6251\u5206\u5e03\u4f7f\u7528 `maxSkew` \u53c2\u6570\u6765\u5b9a\u4e49 Pod \u53ef\u4ee5\u4e0d\u5747\u5300\u5206\u5e03\u7684\u7a0b\u5ea6\u3002\n\n\u4f46\u8fd8\u6709\u6ca1\u6709\u4e00\u79cd\u65b9\u5f0f\u53ef\u4ee5\u63a7\u5236\u5e94\u5206\u5e03\u5230\u7684\u57df\u6570\u3002\n\u4e00\u4e9b\u7528\u6237\u60f3\u8981\u5f3a\u5236\u5728\u81f3\u5c11\u6307\u5b9a\u4e2a\u6570\u7684\u82e5\u5e72\u57df\u5185\u5206\u5e03 Pod\uff1b\u5e76\u4e14\u5982\u679c\u76ee\u524d\u5b58\u5728\u7684\u57df\u4e2a\u6570\u8fd8\u4e0d\u591f\uff0c\n\u5219\u4f7f\u7528 cluster-autoscaler \u5236\u5907\u65b0\u7684\u57df\u3002\n\nKubernetes v1.24 \u4ee5 Alpha \u7279\u6027\u7684\u5f62\u5f0f\u4e3a Pod \u62d3\u6251\u5206\u5e03\u7ea6\u675f\u5f15\u5165\u4e86 `minDomains` \u53c2\u6570\u3002\n\u901a\u8fc7 `minDomains` \u53c2\u6570\uff0c\u4f60\u53ef\u4ee5\u5b9a\u4e49\u6700\u5c0f\u57df\u6570\u3002\n\n\u4f8b\u5982\uff0c\u5047\u8bbe\u6709 3 \u4e2a Node \u5177\u6709\u8db3\u591f\u7684\u5bb9\u91cf\uff0c\n\u4e14\u65b0\u5efa\u7684 ReplicaSet \u5728\u5176 Pod \u6a21\u677f\u4e2d\u5e26\u6709\u4ee5\u4e0b `topologySpreadConstraints`\u3002\n\n```yaml\n.", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n"}, "__type__": "1"}, "45a46f47-c07f-46c1-b687-ec087ff708f2": {"__data__": {"id_": "45a46f47-c07f-46c1-b687-ec087ff708f2", "embedding": null, "metadata": {}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6", "node_type": null, "metadata": {}, "hash": "1ae8b495a1173548bc3adcfa4e17b6b0d706e46a12425d4b18f8fbd40b207c49"}, "2": {"node_id": "cc341eac-530c-4c83-b038-17491c852738", "node_type": null, "metadata": {}, "hash": "661b42a80b09171fca8795eba3777bf28b45f95d3d2ae13e221c390d77343580"}, "3": {"node_id": "31abd24a-7855-423d-a0ef-e79a1b5541dc", "node_type": null, "metadata": {}, "hash": "df77b484d5982ccdd5072e8506bea4670670b4b94425551ed7a6be007136984d"}}, "hash": "300a6eaf16f32a29cbb24bb112f74d9e12cbc3d0c23d18708ad35b2aa1108129", "text": "```yaml\n.\ntopologySpreadConstraints:\n- maxSkew: 1\n  minDomains: 5 # \u9700\u8981\u81f3\u5c11 5 \u4e2a Node\uff08\u56e0\u4e3a\u6bcf\u4e2a Node \u90fd\u6709\u552f\u4e00\u7684 hostname\uff09\n  whenUnsatisfiable: DoNotSchedule # \u53ea\u6709\u4f7f\u7528 DoNotSchedule \u65f6 minDomains \u624d\u6709\u6548\n  topologyKey: kubernetes.io/hostname\n  labelSelector:\n    matchLabels:\n        foo: bar\n```\n\n\u5728\u8fd9\u4e2a\u573a\u666f\u4e2d\uff0c3 \u4e2a Pod \u5c06\u88ab\u5206\u522b\u8c03\u5ea6\u5230\u8fd9 3 \u4e2a Node \u4e0a\uff0c\n\u4f46 ReplicaSet \u4e2d\u7684\u5176\u5b83 2 \u4e2a Pod \u5728\u66f4\u591a Node \u63a5\u5165\u5230\u96c6\u7fa4\u4e4b\u524d\u5c06\u65e0\u6cd5\u88ab\u8c03\u5ea6\u3002\n\n\u4f60\u53ef\u4ee5\u60f3\u8c61\u96c6\u7fa4\u81ea\u52a8\u6269\u7f29\u5668\u57fa\u4e8e\u8fd9\u4e9b\u4e0d\u53ef\u8c03\u5ea6\u7684 Pod \u5236\u5907\u65b0\u7684 Node\uff0c\n\u56e0\u6b64\u8fd9\u4e9b\u526f\u672c\u6700\u540e\u5c06\u5206\u5e03\u5230 5 \u4e2a Node \u4e0a\u3002", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n"}, "__type__": "1"}, "31abd24a-7855-423d-a0ef-e79a1b5541dc": {"__data__": {"id_": "31abd24a-7855-423d-a0ef-e79a1b5541dc", "embedding": null, "metadata": {}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6", "node_type": null, "metadata": {}, "hash": "1ae8b495a1173548bc3adcfa4e17b6b0d706e46a12425d4b18f8fbd40b207c49"}, "2": {"node_id": "45a46f47-c07f-46c1-b687-ec087ff708f2", "node_type": null, "metadata": {}, "hash": "300a6eaf16f32a29cbb24bb112f74d9e12cbc3d0c23d18708ad35b2aa1108129"}, "3": {"node_id": "90cd4050-91e5-424a-891f-c11d650bf62b", "node_type": null, "metadata": {}, "hash": "91cf75a91f7aad4a73676b7638ec2a3b338579e9e7d3cf01e8cd1c50e954c1b9"}}, "hash": "df77b484d5982ccdd5072e8506bea4670670b4b94425551ed7a6be007136984d", "text": "KEP-3094\uff1a\u8ba1\u7b97 podTopologySpread \u504f\u5dee\u65f6\u8003\u8651\u6c61\u70b9/\u5bb9\u5fcd\u5ea6\n\n\u5728\u672c\u6b21\u589e\u5f3a\u4e4b\u524d\uff0c\u5f53\u4f60\u90e8\u7f72\u5df2\u7ecf\u914d\u7f6e\u4e86 `topologySpreadConstraints` \u7684 Pod \u65f6\uff0ckube-scheduler\n\u5c06\u5728\u8fc7\u6ee4\u548c\u8bc4\u5206\u65f6\u8003\u8651\u6ee1\u8db3 Pod \u7684 nodeAffinity \u548c nodeSelector \u7684\u8282\u70b9\uff0c\n\u4f46\u4e0d\u5173\u5fc3\u4f20\u5165\u7684 Pod \u662f\u5426\u5bb9\u5fcd\u8282\u70b9\u6c61\u70b9\u3002\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5177\u6709\u4e0d\u53ef\u5bb9\u5fcd\u6c61\u70b9\u7684\u8282\u70b9\u6210\u4e3a\u552f\u4e00\u7684\u5206\u5e03\u5019\u9009\uff0c\n\u56e0\u6b64\u5982\u679c Pod \u4e0d\u5bb9\u5fcd\u6c61\u70b9\uff0c\u5219\u8be5 Pod \u5c06\u5361\u5728 Pending \u72b6\u6001\u3002\n\n\u4e3a\u4e86\u80fd\u591f\u5728\u8ba1\u7b97\u5206\u5e03\u504f\u5dee\u65f6\u9488\u5bf9\u8981\u8003\u8651\u7684\u8282\u70b9\u4f5c\u51fa\u7c92\u5ea6\u66f4\u7cbe\u7ec6\u7684\u51b3\u7b56\uff0cKubernetes 1.25\n\u5728 `topologySpreadConstraints` \u4e2d\u5f15\u5165\u4e86\u4e24\u4e2a\u65b0\u5b57\u6bb5 `nodeAffinityPolicy`\n\u548c `nodeTaintPolicy` \u6765\u5b9a\u4e49\u8282\u70b9\u5305\u542b\u7b56\u7565\u3002", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n"}, "__type__": "1"}, "90cd4050-91e5-424a-891f-c11d650bf62b": {"__data__": {"id_": "90cd4050-91e5-424a-891f-c11d650bf62b", "embedding": null, "metadata": {}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6", "node_type": null, "metadata": {}, "hash": "1ae8b495a1173548bc3adcfa4e17b6b0d706e46a12425d4b18f8fbd40b207c49"}, "2": {"node_id": "31abd24a-7855-423d-a0ef-e79a1b5541dc", "node_type": null, "metadata": {}, "hash": "df77b484d5982ccdd5072e8506bea4670670b4b94425551ed7a6be007136984d"}, "3": {"node_id": "2e1b1e33-46a3-4d0a-b96d-6dec6943ecba", "node_type": null, "metadata": {}, "hash": "f5ce879517190665285d5eeb1d11a6897cc56385af1f91d4188538c59dd7b6bf"}}, "hash": "91cf75a91f7aad4a73676b7638ec2a3b338579e9e7d3cf01e8cd1c50e954c1b9", "text": "\u5e94\u7528\u8fd9\u4e9b\u7b56\u7565\u7684\u6e05\u5355\u5982\u4e0b\u6240\u793a\uff1a\n\n```yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example-pod\nspec:\n  # \u914d\u7f6e\u62d3\u6251\u5206\u5e03\u7ea6\u675f\n  topologySpreadConstraints:\n    - maxSkew: \n      # .\n      nodeAffinityPolicy: [Honor|Ignore]\n      nodeTaintsPolicy: [Honor|Ignore]\n  # \u5728\u6b64\u5904\u6dfb\u52a0\u5176\u4ed6 Pod \u5b57\u6bb5\n```\n\n`nodeAffinityPolicy` \u5b57\u6bb5\u6307\u793a Kubernetes \u5982\u4f55\u5904\u7406 Pod \u7684 `nodeAffinity` \u6216 `nodeSelector`\n\u4ee5\u8ba1\u7b97 Pod \u62d3\u6251\u5206\u5e03\u3002\u5982\u679c\u662f `Honor`\uff0c\u5219 kube-scheduler \u5728\u8ba1\u7b97\u5206\u5e03\u504f\u5dee\u65f6\u4f1a\u8fc7\u6ee4\u6389\u4e0d\u5339\u914d\n`nodeAffinity`/`nodeSelector` \u7684\u8282\u70b9\u3002\u5982\u679c\u662f `Ignore`\uff0c\u5219\u4f1a\u5305\u62ec\u6240\u6709\u8282\u70b9\uff0c\u4e0d\u4f1a\u7ba1\u5b83\u4eec\u662f\u5426\u4e0e\nPod \u7684 `nodeAffinity`/`nodeSelector` \u5339\u914d\u3002\n\n\u4e3a\u4e86\u5411\u540e\u517c\u5bb9\uff0c`nodeAffinityPolicy` \u9ed8\u8ba4\u4e3a `Honor`\u3002\n\n`nodeTaintsPolicy` \u5b57\u6bb5\u5b9a\u4e49 Kubernetes \u8ba1\u7b97 Pod \u62d3\u6251\u5206\u5e03\u65f6\u5982\u4f55\u5bf9\u5f85\u8282\u70b9\u6c61\u70b9\u3002", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n"}, "__type__": "1"}, "2e1b1e33-46a3-4d0a-b96d-6dec6943ecba": {"__data__": {"id_": "2e1b1e33-46a3-4d0a-b96d-6dec6943ecba", "embedding": null, "metadata": {}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6", "node_type": null, "metadata": {}, "hash": "1ae8b495a1173548bc3adcfa4e17b6b0d706e46a12425d4b18f8fbd40b207c49"}, "2": {"node_id": "90cd4050-91e5-424a-891f-c11d650bf62b", "node_type": null, "metadata": {}, "hash": "91cf75a91f7aad4a73676b7638ec2a3b338579e9e7d3cf01e8cd1c50e954c1b9"}, "3": {"node_id": "5b9ddfb1-90ba-4c58-83b4-3916d8be1b26", "node_type": null, "metadata": {}, "hash": "93abfcffd3c8571178571a8ff3dd0c7e72406396f04bb374545d6fd525a2cb03"}}, "hash": "f5ce879517190665285d5eeb1d11a6897cc56385af1f91d4188538c59dd7b6bf", "text": "\u5982\u679c\u662f `Honor`\uff0c\u5219\u53ea\u6709\u914d\u7f6e\u4e86\u6c61\u70b9\u7684\u8282\u70b9\u4e0a\u7684\u4f20\u5165 Pod \u5e26\u6709\u5bb9\u5fcd\u6807\u7b7e\u65f6\u8be5\u8282\u70b9\u624d\u4f1a\u88ab\u5305\u62ec\u5728\u5206\u5e03\u504f\u5dee\u7684\u8ba1\u7b97\u4e2d\u3002\n\u5982\u679c\u662f `Ignore`\uff0c\u5219\u5728\u8ba1\u7b97\u5206\u5e03\u504f\u5dee\u65f6 kube-scheduler \u6839\u672c\u4e0d\u4f1a\u8003\u8651\u8282\u70b9\u6c61\u70b9\uff0c\n\u56e0\u6b64\u5e26\u6709\u672a\u5bb9\u5fcd\u6c61\u70b9\u7684 Pod \u7684\u8282\u70b9\u4e5f\u4f1a\u88ab\u5305\u62ec\u8fdb\u53bb\u3002\n\n\u4e3a\u4e86\u5411\u540e\u517c\u5bb9\uff0c`nodeTaintsPolicy` \u9ed8\u8ba4\u4e3a `Ignore`\u3002\n\n\u8be5\u7279\u6027\u5728 v1.25 \u4e2d\u4f5c\u4e3a Alpha \u5f15\u5165\u3002\u9ed8\u8ba4\u88ab\u7981\u7528\uff0c\u56e0\u6b64\u5982\u679c\u8981\u5728 v1.25 \u4e2d\u4f7f\u7528\u6b64\u7279\u6027\uff0c\n\u5219\u5fc5\u987b\u663e\u5f0f\u542f\u7528\u7279\u6027\u95e8\u63a7 `NodeInclusionPolicyInPodTopologySpread`\u3002\n\u5728\u63a5\u4e0b\u6765\u7684 v1.26 \u7248\u672c\u4e2d\uff0c\u76f8\u5173\u7279\u6027\u8fdb\u9636\u81f3 Beta \u5e76\u9ed8\u8ba4\u88ab\u542f\u7528\u3002", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n"}, "__type__": "1"}, "5b9ddfb1-90ba-4c58-83b4-3916d8be1b26": {"__data__": {"id_": "5b9ddfb1-90ba-4c58-83b4-3916d8be1b26", "embedding": null, "metadata": {}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6", "node_type": null, "metadata": {}, "hash": "1ae8b495a1173548bc3adcfa4e17b6b0d706e46a12425d4b18f8fbd40b207c49"}, "2": {"node_id": "2e1b1e33-46a3-4d0a-b96d-6dec6943ecba", "node_type": null, "metadata": {}, "hash": "f5ce879517190665285d5eeb1d11a6897cc56385af1f91d4188538c59dd7b6bf"}, "3": {"node_id": "54a04ff9-769e-4344-9e60-684dfa709b51", "node_type": null, "metadata": {}, "hash": "2368eebc620a6b4886ad1cd794753b7222e61b56e539b0fb387e629c07a1533e"}}, "hash": "93abfcffd3c8571178571a8ff3dd0c7e72406396f04bb374545d6fd525a2cb03", "text": "KEP-3243\uff1a\u6eda\u52a8\u5347\u7ea7\u540e\u5173\u6ce8 Pod \u62d3\u6251\u5206\u5e03\n\nPod \u62d3\u6251\u5206\u5e03\u4f7f\u7528 `labelSelector` \u5b57\u6bb5\u6765\u6807\u8bc6\u8981\u8ba1\u7b97\u5206\u5e03\u7684 Pod \u7ec4\u3002\n\u5728\u9488\u5bf9 Deployment \u8fdb\u884c\u62d3\u6251\u5206\u5e03\u65f6\uff0c\u901a\u5e38\u4f1a\u4f7f\u7528 Deployment \u7684\n`labelSelector` \u4f5c\u4e3a\u62d3\u6251\u5206\u5e03\u7ea6\u675f\u4e2d\u7684 `labelSelector`\u3002\n\u4f46\u8fd9\u610f\u5473\u7740 Deployment \u7684\u6240\u6709 Pod \u90fd\u53c2\u4e0e\u5206\u5e03\u8ba1\u7b97\uff0c\u4e0e\u8fd9\u4e9b Pod \u662f\u5426\u5c5e\u4e8e\u4e0d\u540c\u7684\u7248\u672c\u65e0\u5173\u3002\n\u56e0\u6b64\uff0c\u5728\u53d1\u5e03\u65b0\u7248\u672c\u65f6\uff0c\u5206\u5e03\u5c06\u540c\u65f6\u5e94\u7528\u5230\u65b0\u65e7 ReplicaSet \u7684 Pod\uff0c\n\u5e76\u5728\u65b0\u7684 ReplicaSet \u5b8c\u5168\u53d1\u5e03\u4e14\u65e7\u7684 ReplicaSet \u88ab\u4e0b\u7ebf\u65f6\uff0c\u6211\u4eec\u7559\u4e0b\u7684\u5b9e\u9645\u5206\u5e03\u53ef\u80fd\u4e0e\u9884\u671f\u4e0d\u7b26\uff0c\n\u8fd9\u662f\u56e0\u4e3a\u65e7 ReplicaSet \u4e2d\u5df2\u5220\u9664\u7684 Pod \u5c06\u5bfc\u81f4\u5269\u4f59 Pod \u7684\u5206\u5e03\u4e0d\u5747\u5300\u3002", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n"}, "__type__": "1"}, "54a04ff9-769e-4344-9e60-684dfa709b51": {"__data__": {"id_": "54a04ff9-769e-4344-9e60-684dfa709b51", "embedding": null, "metadata": {}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6", "node_type": null, "metadata": {}, "hash": "1ae8b495a1173548bc3adcfa4e17b6b0d706e46a12425d4b18f8fbd40b207c49"}, "2": {"node_id": "5b9ddfb1-90ba-4c58-83b4-3916d8be1b26", "node_type": null, "metadata": {}, "hash": "93abfcffd3c8571178571a8ff3dd0c7e72406396f04bb374545d6fd525a2cb03"}, "3": {"node_id": "7cda0fe3-358e-4272-9dd3-5f14ec4b126e", "node_type": null, "metadata": {}, "hash": "9420d0bd1609b916c1aa3af911c3905f413761792d9fbbe09dbf65931dcbe9c0"}}, "hash": "2368eebc620a6b4886ad1cd794753b7222e61b56e539b0fb387e629c07a1533e", "text": "\u4e3a\u4e86\u907f\u514d\u8fd9\u4e2a\u95ee\u9898\uff0c\u8fc7\u53bb\u7528\u6237\u9700\u8981\u5411 Deployment \u6dfb\u52a0\u4fee\u8ba2\u7248\u6807\u7b7e\uff0c\u5e76\u5728\u6bcf\u6b21\u6eda\u52a8\u5347\u7ea7\u65f6\u624b\u52a8\u66f4\u65b0\n\uff08\u5305\u62ec Pod \u6a21\u677f\u4e0a\u7684\u6807\u7b7e\u548c `topologySpreadConstraints` \u4e2d\u7684 `labelSelector`\uff09\u3002\n\n\u4e3a\u4e86\u901a\u8fc7\u66f4\u7b80\u5355\u7684 API \u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cKubernetes v1.25 \u5f15\u5165\u4e86\u4e00\u4e2a\u540d\u4e3a `matchLabelKeys`\n\u7684\u65b0\u5b57\u6bb5\u5230 `topologySpreadConstraints` \u4e2d\u3002`matchLabelKeys` \u662f\u4e00\u4e2a Pod \u6807\u7b7e\u952e\u5217\u8868\uff0c\n\u7528\u4e8e\u9009\u62e9\u8ba1\u7b97\u5206\u5e03\u65b9\u5f0f\u7684 Pod\u3002\u8fd9\u4e9b\u952e\u7528\u4e8e\u67e5\u627e Pod \u88ab\u8c03\u5ea6\u65f6\u7684\u6807\u7b7e\u503c\uff0c\n\u8fd9\u4e9b\u952e\u503c\u6807\u7b7e\u4e0e `labelSelector` \u8fdb\u884c\u903b\u8f91\u4e0e\u8fd0\u7b97\uff0c\u4e3a\u65b0\u589e Pod \u8ba1\u7b97\u5206\u5e03\u65b9\u5f0f\u9009\u62e9\u73b0\u6709 Pod \u7ec4\u3002\n\n\u501f\u52a9 `matchLabelKeys`\uff0c\u4f60\u65e0\u9700\u5728\u4fee\u8ba2\u7248\u53d8\u5316\u65f6\u66f4\u65b0 `pod.spec`\u3002", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n"}, "__type__": "1"}, "7cda0fe3-358e-4272-9dd3-5f14ec4b126e": {"__data__": {"id_": "7cda0fe3-358e-4272-9dd3-5f14ec4b126e", "embedding": null, "metadata": {}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6", "node_type": null, "metadata": {}, "hash": "1ae8b495a1173548bc3adcfa4e17b6b0d706e46a12425d4b18f8fbd40b207c49"}, "2": {"node_id": "54a04ff9-769e-4344-9e60-684dfa709b51", "node_type": null, "metadata": {}, "hash": "2368eebc620a6b4886ad1cd794753b7222e61b56e539b0fb387e629c07a1533e"}, "3": {"node_id": "6a20212d-6f0c-449a-af0f-fdeab3790e28", "node_type": null, "metadata": {}, "hash": "99102840ac855a10477473d447a9d613da580316f3a0c7a9957cf2cb6ba7ffd1"}}, "hash": "9420d0bd1609b916c1aa3af911c3905f413761792d9fbbe09dbf65931dcbe9c0", "text": "spec`\u3002\n\u63a7\u5236\u5668\u6216 Operator \u7ba1\u7406\u6eda\u52a8\u5347\u7ea7\u65f6\u53ea\u9700\u9488\u5bf9\u4e0d\u540c\u4fee\u8ba2\u7248\u4e3a\u76f8\u540c\u7684\u6807\u7b7e\u952e\u8bbe\u7f6e\u4e0d\u540c\u7684\u503c\u5373\u53ef\u3002\n\u8c03\u5ea6\u7a0b\u5e8f\u5c06\u57fa\u4e8e `matchLabelKeys` \u81ea\u52a8\u5b8c\u6210\u8d4b\u503c\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u6b63\u914d\u7f6e Deployment\uff0c\n\u5219\u53ef\u4ee5\u4f7f\u7528\u7531 Deployment \u63a7\u5236\u5668\u81ea\u52a8\u6dfb\u52a0\u7684\npod-template-hash\n\u7684\u6807\u7b7e\u952e\u6765\u533a\u5206\u5355\u4e2a Deployment \u4e2d\u7684\u4e0d\u540c\u4fee\u8ba2\u7248\u3002\n\n```yaml\ntopologySpreadConstraints:\n    - maxSkew: 1\n      topologyKey: kubernetes.io/hostname\n      whenUnsatisfiable: DoNotSchedule\n      labelSelector:\n        matchLabels:\n          app: foo\n      matchLabelKeys:\n        - pod-template-hash\n```\n\n\n\n\u53c2\u4e0e\u5176\u4e2d\n\n\u8fd9\u4e9b\u7279\u6027\u5f52\nKubernetes SIG Scheduling \u7ba1\u7406\u3002\n\n\u8bf7\u52a0\u5165\u6211\u4eec\u5206\u4eab\u53cd\u9988\u3002\u6211\u4eec\u671f\u5f85\u8046\u542c\u4f60\u7684\u58f0\u97f3\uff01", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n"}, "__type__": "1"}, "6a20212d-6f0c-449a-af0f-fdeab3790e28": {"__data__": {"id_": "6a20212d-6f0c-449a-af0f-fdeab3790e28", "embedding": null, "metadata": {}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6", "node_type": null, "metadata": {}, "hash": "1ae8b495a1173548bc3adcfa4e17b6b0d706e46a12425d4b18f8fbd40b207c49"}, "2": {"node_id": "7cda0fe3-358e-4272-9dd3-5f14ec4b126e", "node_type": null, "metadata": {}, "hash": "9420d0bd1609b916c1aa3af911c3905f413761792d9fbbe09dbf65931dcbe9c0"}}, "hash": "99102840ac855a10477473d447a9d613da580316f3a0c7a9957cf2cb6ba7ffd1", "text": "\u4e86\u89e3\u66f4\u591a\n\n- Kubernetes \u6587\u6863\u4e2d\u7684 Pod \u62d3\u6251\u5206\u5e03\u7ea6\u675f\n- KEP-3022\uff1aPod \u62d3\u6251\u5206\u5e03\u4e2d\u7684\u6700\u5c0f\u57df\u6570\n- KEP-3094\uff1a\u8ba1\u7b97 podTopologySpread \u504f\u5dee\u65f6\u8003\u8651\u6c61\u70b9/\u5bb9\u5fcd\u5ea6\n- KEP-3243\uff1a\u6eda\u52a8\u5347\u7ea7\u540e\u5173\u6ce8 Pod \u62d3\u6251\u5206\u5e03", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n"}, "__type__": "1"}, "b19a3b2a-3330-4e92-a517-dd7288520dba": {"__data__": {"id_": "b19a3b2a-3330-4e92-a517-dd7288520dba", "embedding": null, "metadata": {}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "31b065d7-a16d-41f4-addb-ad12a18e24b6", "node_type": null, "metadata": {}, "hash": null}}, "hash": "ecfea34124be01ddf47e2ccd60163cb7547e0bf35b2d36865f30657fc5ae493f", "text": "The provided text is about two different topics related to Kubernetes. The first topic is about the enhancements made to Pod topology distribution in Kubernetes, which introduces three Kubernetes Enhancement Proposals (KEPs) related to Pod topology distribution. The second topic is about topology spread constraints in Kubernetes, which involves specifying how pods should be distributed across different nodes in a cluster based on specified topology keys and label selectors.\n\nSome questions that the first topic can answer include:\n- What enhancements have been made to Pod topology distribution in Kubernetes?\n- How can the minimum number of domains for Pod distribution be specified?\n- How does Kubernetes handle node affinity, node selector, and node taints when calculating Pod topology distribution?\n- How can the issue of uneven distribution be avoided during rolling upgrades on Deployments?\n\nSome questions that the second topic can answer include:\n- What are topology spread constraints in Kubernetes?\n- How can I specify topology spread constraints for a Deployment?\n- What is the purpose of the `maxSkew`, `topologyKey`, and `whenUnsatisfiable` fields in the topology spread constraints?\n- How can I ensure that pods with a specific label are evenly distributed across nodes in a Kubernetes cluster?", "start_char_idx": null, "end_char_idx": null, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n"}, "__type__": "1"}}, "docstore/ref_doc_info": {"31b065d7-a16d-41f4-addb-ad12a18e24b6": {"node_ids": ["cc341eac-530c-4c83-b038-17491c852738", "45a46f47-c07f-46c1-b687-ec087ff708f2", "31abd24a-7855-423d-a0ef-e79a1b5541dc", "90cd4050-91e5-424a-891f-c11d650bf62b", "2e1b1e33-46a3-4d0a-b96d-6dec6943ecba", "5b9ddfb1-90ba-4c58-83b4-3916d8be1b26", "54a04ff9-769e-4344-9e60-684dfa709b51", "7cda0fe3-358e-4272-9dd3-5f14ec4b126e", "6a20212d-6f0c-449a-af0f-fdeab3790e28", "b19a3b2a-3330-4e92-a517-dd7288520dba"], "metadata": {}}}}